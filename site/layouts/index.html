{{ define "main" }}
<div id="koto-safe-container">
    <style>
        /* === 1. å®‰å…¨éš”ç¦»æ ·å¼ (åªåœ¨å½“å‰ ID ä¸‹ç”Ÿæ•ˆ) === */
        #koto-safe-container {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            color: #333;
            line-height: 1.6;
            width: 100%;
            overflow-x: hidden; /* é˜²æ­¢æ¨ªå‘æ»šåŠ¨æ¡å´©å */
            background-color: #fff;
        }

        /* å¼ºåˆ¶ç›’æ¨¡å‹ï¼Œé˜²æ­¢å¸ƒå±€æ’‘ç ´ */
        #koto-safe-container * {
            box-sizing: border-box; 
        }

        #koto-safe-container a { text-decoration: none; color: inherit; transition: 0.3s; }
        #koto-safe-container ul { list-style: none; padding: 0; margin: 0; }
        #koto-safe-container img { max-width: 100%; display: block; }

        /* å˜é‡å®šä¹‰ */
        #koto-safe-container {
            --k-red: #C41E3A;
            --k-dark: #2C3E50;
            --k-gray: #F5F7FA;
            --k-light: #FFFFFF;
        }

        /* === 2. Hero è½®æ’­å›¾ === */
        .ks-hero-wrapper {
            position: relative;
            width: 100%;
            height: 550px; /* å›ºå®šé«˜åº¦ */
            background-color: var(--k-gray);
            overflow: hidden;
        }

        .ks-hero-slide {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            opacity: 0;
            transition: opacity 0.8s ease-in-out;
            display: flex; align-items: center; justify-content: center;
            z-index: 1;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        }

        .ks-hero-slide.active { opacity: 1; z-index: 2; }

        /* çº¢è‰²æ–¹å— */
        .ks-hero-box {
            background: rgba(196, 30, 58, 0.92);
            padding: 40px 50px;
            border-radius: 10px;
            text-align: center;
            color: white;
            max-width: 90%;
            width: 600px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }

        .ks-hero-box h1 {
            font-size: 2.2rem; margin: 0 0 15px 0; color: white; font-weight: 800; line-height: 1.2;
        }
        .ks-hero-box p { font-size: 1.1rem; margin-bottom: 25px; color: #f0f0f0; }

        .ks-btn {
            display: inline-block; background: white; color: var(--k-red);
            padding: 12px 35px; border-radius: 50px; font-weight: bold;
        }
        .ks-btn:hover { transform: scale(1.05); }

        .ks-dots {
            position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%); z-index: 10; display: flex; gap: 10px;
        }
        .ks-dot {
            width: 10px; height: 10px; background: rgba(255,255,255,0.4); border-radius: 50%; cursor: pointer;
        }
        .ks-dot.active { background: white; transform: scale(1.2); }

        /* === 3. æœåŠ¡å¡ç‰‡ (ä¸Šå›¾ - ä¸­çº¢èƒ¶å›Š - ä¸‹æ–‡) === */
        .ks-section { padding: 60px 5%; background: white; }
        
        .ks-title-center { text-align: center; margin-bottom: 50px; }
        .ks-title-center h2 { color: var(--k-red); font-size: 2rem; font-weight: bold; margin: 0; }

        .ks-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 30px;
        }

        .ks-card {
            background: white;
            border: 1px solid #eee;
            border-radius: 12px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            padding-bottom: 30px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.03);
            transition: transform 0.3s;
        }
        .ks-card:hover { transform: translateY(-5px); box-shadow: 0 15px 30px rgba(0,0,0,0.08); }

        /* å›¾ç‰‡é¢„ç•™ä½ */
        .ks-card-img-box {
            width: 100%;
            height: 200px;
            background-color: #e0e0e0;
            display: flex; align-items: center; justify-content: center;
            color: #999; font-weight: bold;
            margin-bottom: 25px;
        }
        .ks-card-img-box img { width: 100%; height: 100%; object-fit: cover; }

        /* çº¢è‰²èƒ¶å›Šæ ‡é¢˜ */
        .ks-card-pill {
            background-color: var(--k-red);
            color: white;
            display: inline-block;
            padding: 8px 30px;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: bold;
            margin-bottom: 20px;
            box-shadow: 0 4px 10px rgba(196, 30, 58, 0.2);
        }

        .ks-card-desc {
            color: #666; font-size: 0.95rem; line-height: 1.6; padding: 0 20px;
        }

        /* === 4. æ–°é—»æ»‘å— === */
        .ks-news-bg { background: #fafafa; padding: 60px 20px; }
        .ks-news-wrapper { max-width: 1200px; margin: 0 auto; }
        
        .ks-news-scroll {
            display: flex; overflow-x: auto; gap: 25px; padding: 10px 5px 30px 5px;
            scroll-snap-type: x mandatory;
        }
        .ks-news-scroll::-webkit-scrollbar { height: 6px; }
        .ks-news-scroll::-webkit-scrollbar-thumb { background: #ccc; border-radius: 3px; }

        .ks-news-item {
            min-width: 300px; max-width: 300px; flex: 0 0 auto; scroll-snap-align: start;
            background: white; border-radius: 10px; overflow: hidden;
            box-shadow: 0 3px 10px rgba(0,0,0,0.05); display: block;
        }
    </style>

    <div class="ks-hero-wrapper" id="ksHero">
        <div class="ks-hero-slide active" style="background-color: #ddd; background-image: url('');">
            <div class="ks-hero-box">
                <h1>Expert Guidance for<br>Your Canadian Journey</h1>
                <p>åŸºäºå®˜æ–¹ CRS æ ‡å‡†çš„ç²¾å‡†è§„åˆ’ï¼Œä»ç•™å­¦åˆ°ç§»æ°‘ï¼Œä¸ºæ‚¨å®šåˆ¶æœ€ä¼˜è·¯å¾„ã€‚</p>
                <a href="/assessment" class="ks-btn">å¼€å§‹å…è´¹è¯„ä¼° &rarr;</a>
            </div>
        </div>
        <div class="ks-hero-slide" style="background-color: #ccc; background-image: url('');">
            <div class="ks-hero-box">
                <h1>ç¾åŠ åæ ¡ç›´é€šè½¦</h1>
                <p>é¡¶å°–åæ ¡æ–‡ä¹¦å®šåˆ¶ï¼Œä»å°å­¦åˆ°åšå£«çš„å…¨é¾„æ®µç”³è¯·æœåŠ¡ã€‚</p>
                <a href="/services" class="ks-btn">æŸ¥çœ‹ç•™å­¦æœåŠ¡</a>
            </div>
        </div>
        <div class="ks-hero-slide" style="background-color: #bbb; background-image: url('');">
            <div class="ks-hero-box">
                <h1>ç–‘éš¾ç­¾è¯ä¸“å®¶</h1>
                <p>å­¦ç­¾ã€å·¥ç­¾ã€æ—…æ¸¸ç­¾åŠæ‹’ç­¾ç¿»æ¡ˆï¼ŒæŒç‰Œé¡¾é—®å…¨ç¨‹è·Ÿè¿›ã€‚</p>
                <a href="/contact" class="ks-btn">è”ç³»æˆ‘ä»¬</a>
            </div>
        </div>

        <div class="ks-dots">
            <span class="ks-dot active" onclick="ksSetHero(0)"></span>
            <span class="ks-dot" onclick="ksSetHero(1)"></span>
            <span class="ks-dot" onclick="ksSetHero(2)"></span>
        </div>
    </div>

    <div class="ks-section">
        <div class="ks-title-center">
            <h2>æˆ‘ä»¬çš„æ ¸å¿ƒæœåŠ¡</h2>
        </div>
        
        <div class="ks-grid">
            <div class="ks-card">
                <div class="ks-card-img-box">
                    é›…æ€å›¾ç‰‡ä½
                </div>
                <div class="ks-card-pill">é›…æ€/æ€åŸ¹æåˆ†</div>
                <div class="ks-card-desc">åå¸ˆä¸€å¯¹ä¸€ç²¾å‡†æŒ‡å¯¼ï¼Œé’ˆå¯¹æ€§çªç ´å£è¯­å†™ä½œç“¶é¢ˆï¼ŒåŠ©æ‚¨å¿«é€Ÿè¾¾åˆ°ç§»æ°‘åˆ†æ•°è¦æ±‚ã€‚</div>
            </div>

            <div class="ks-card">
                <div class="ks-card-img-box">ç•™å­¦å›¾ç‰‡ä½</div>
                <div class="ks-card-pill">ç¾åŠ ç•™å­¦è§„åˆ’</div>
                <div class="ks-card-desc">ä»å°å­¦åˆ°åšå£«çš„å…¨é¾„æ®µç”³è¯·æœåŠ¡ã€‚é¡¶å°–åæ ¡æ–‡ä¹¦å®šåˆ¶ï¼Œå­¦ç­¾åŠç†åŠæ‹’ç­¾ç¿»æ¡ˆã€‚</div>
            </div>

            <div class="ks-card">
                <div class="ks-card-img-box">åŠ ç§»æ°‘å›¾ç‰‡ä½</div>
                <div class="ks-card-pill">åŠ æ‹¿å¤§ç§»æ°‘</div>
                <div class="ks-card-desc">å¿«é€Ÿé€šé“ (Express Entry)ã€çœæå (PNP)ã€å®¶åº­å›¢èšåŠé…å¶å·¥ç­¾å…¨ç±»åˆ«åŠç†ã€‚</div>
            </div>

            <div class="ks-card">
                <div class="ks-card-img-box">ç¾ç§»æ°‘å›¾ç‰‡ä½</div>
                <div class="ks-card-pill">ç¾å›½ç§»æ°‘</div>
                <div class="ks-card-desc">æ°å‡ºäººæ‰ (EB-1)ã€å›½å®¶åˆ©ç›Šè±å… (NIW) åŠè·¨å›½é«˜ç®¡ç§»æ°‘ (L1/EB-1C) ä¸“ä¸šå’¨è¯¢ã€‚</div>
            </div>
        </div>
    </div>

    <div class="ks-news-bg">
        <div class="ks-news-wrapper">
            <h2 style="color: #2C3E50; margin-bottom: 30px; font-size: 1.5rem; font-weight: bold;">æœ€æ–°ç§»æ°‘èµ„è®¯</h2>
            
            <div class="ks-news-scroll">
                {{ range first 6 .Site.RegularPages }}
                <a href="{{ .Permalink }}" class="ks-news-item">
                    
                    {{/* å›¾ç‰‡é€»è¾‘ï¼šå¦‚æœæ²¡å›¾ï¼Œç”¨ /images/logo-koto.png */}}
                    {{ $img := "" }}
                    {{ if .Params.image }}
                        {{ $res := .Resources.GetMatch .Params.image }}
                        {{ if $res }}{{ $img = $res.RelPermalink }}{{ else }}{{ $img = .Params.image }}{{ end }}
                    {{ end }}
                    
                    {{/* è¿™é‡Œçš„é€»è¾‘ï¼šå¦‚æœ $img è¿˜æ˜¯ç©ºçš„ï¼Œå°±å¼ºåˆ¶èµ‹å€¼ä¸º Logo è·¯å¾„ */}}
                    {{ if eq $img "" }}
                        {{ $img = "/images/logo-koto.png" }}
                    {{ end }}
                    
                    <img src="{{ $img }}" style="width: 100%; height: 180px; object-fit: cover;">
                    
                    <div style="padding: 20px;">
                        <div style="font-size: 0.85rem; color: #888; margin-bottom: 8px;">
                            ğŸ“… {{ .Date.Format "2006-01-02" }}
                        </div>

                        <h3 style="margin: 0 0 10px 0; font-size: 1.1rem; line-height: 1.4; color: #333;">{{ .Title }}</h3>
                        <p style="font-size: 0.9rem; color: #666; margin:0;">{{ .Summary | truncate 50 }}</p>
                        <div style="color: #C41E3A; font-weight: bold; font-size: 0.9rem; margin-top: 15px;">é˜…è¯»å…¨æ–‡ &rarr;</div>
                    </div>
                </a>
                {{ end }}
            </div>
        </div>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            let ksIdx = 0;
            const slides = document.querySelectorAll('.ks-hero-slide');
            const dots = document.querySelectorAll('.ks-dot');
            
            // å®‰å…¨æ£€æŸ¥ï¼šå¦‚æœé¡µé¢ä¸Šæ‰¾ä¸åˆ°å…ƒç´ ï¼Œå°±ä¸æ‰§è¡Œï¼Œé˜²æ­¢æŠ¥é”™
            if (slides.length === 0) return;

            function ksUpdate(n) {
                // æ¸…é™¤çŠ¶æ€
                slides.forEach(s => s.classList.remove('active'));
                dots.forEach(d => d.classList.remove('active'));
                
                // è®¡ç®—ç´¢å¼•
                ksIdx = n;
                if (ksIdx >= slides.length) ksIdx = 0;
                if (ksIdx < 0) ksIdx = slides.length - 1;
                
                // æ·»åŠ çŠ¶æ€
                if(slides[ksIdx]) slides[ksIdx].classList.add('active');
                if(dots[ksIdx]) dots[ksIdx].classList.add('active');
            }

            // è‡ªåŠ¨æ’­æ”¾
            let ksTimer = setInterval(() => { ksUpdate(ksIdx + 1); }, 4000);

            // æš´éœ²ç»™å…¨å±€ç‚¹å‡»äº‹ä»¶
            window.ksSetHero = function(n) {
                clearInterval(ksTimer);
                ksUpdate(n);
                ksTimer = setInterval(() => { ksUpdate(ksIdx + 1); }, 4000);
            };
        });
    </script>
</div>
{{ end }}
