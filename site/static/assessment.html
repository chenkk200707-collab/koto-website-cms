<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KOTO 官方 CRS 移民算分器 | 精准评估</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        /* --- KOTO 品牌视觉变量 (参考了你上传的文件) --- */
        :root {
            --bg-cream: #F5F0E6; /* 奶油色背景 */
            --brand-navy: #182B45; /* 深蓝品牌色 */
            --brand-gold: #C5A059; /* 金色点缀 */
            --brand-red: #C14F4F; /* 警示/强调红 */
            --text-dark: #2C2C2C;
            --card-surface: #FFFFFF;
            /* 这种阴影让卡片看起来像立体的软陶 (Claymorphism) */
            --clay-shadow: 8px 8px 16px rgba(166, 156, 142, 0.15), 
                           -8px -8px 16px rgba(255, 255, 255, 0.8);
            --inset-clay: inset 4px 4px 8px rgba(166, 156, 142, 0.1), 
                          inset -4px -4px 8px rgba(255, 255, 255, 0.9);
        }

        /* --- 全局设置 --- */
        * { box-sizing: border-box; }
        body {
            background-color: var(--bg-cream);
            color: var(--text-dark);
            font-family: 'Noto Sans SC', sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        .main-wrapper {
            padding: 20px;
            flex: 1; 
            padding-bottom: 200px; /* 给底部悬浮条留出足够空间 */
        }

        .container { max-width: 900px; margin: 0 auto; }

        /* --- 顶部导航 --- */
        header { 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            padding: 10px 0 40px 0;
        }
        .logo { font-weight: 800; font-size: 1.5rem; color: var(--brand-navy); text-decoration: none; }
        .back-link { color: #666; text-decoration: none; font-size: 0.9rem; font-weight: 500; }
        .back-link:hover { color: var(--brand-gold); }
        
        h1 { text-align: center; color: var(--brand-navy); margin-bottom: 10px; font-size: 1.8rem; }
        .subtitle { text-align: center; color: #666; font-size: 0.9rem; margin-bottom: 40px; }

        /* --- 卡片样式 --- */
        .section-card {
            background: var(--card-surface);
            border-radius: 24px;
            padding: 35px;
            margin-bottom: 30px;
            box-shadow: var(--clay-shadow);
            border: 1px solid rgba(255,255,255,0.6);
            transition: all 0.3s ease;
        }
        .section-card:hover { transform: translateY(-2px); border-color: var(--brand-gold); }

        h2 { 
            color: var(--brand-navy); 
            font-size: 1.2rem; 
            border-bottom: 2px solid #EEE; 
            padding-bottom: 15px; 
            margin-top: 0;
            margin-bottom: 25px; 
            display: flex;
            align-items: center;
        }
        h2::before { content: ''; display: inline-block; width: 6px; height: 20px; background: var(--brand-gold); margin-right: 10px; border-radius: 4px; }

        h3 { font-size: 0.95rem; color: #888; margin-top: 25px; margin-bottom: 15px; text-transform: uppercase; letter-spacing: 1px; }

        .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 25px; }
        .full-width { grid-column: span 2; }

        label { display: block; font-weight: 600; margin-bottom: 10px; font-size: 0.95rem; color: #444; }
        
        /* --- 输入框样式 --- */
        select, input[type="number"] {
            width: 100%;
            padding: 14px;
            border-radius: 12px;
            border: 1px solid transparent;
            background: #F9F7F2;
            box-shadow: var(--inset-clay); /* 内阴影让它看起来是凹进去的 */
            font-size: 1rem;
            color: var(--text-dark);
            outline: none;
            transition: 0.2s;
            cursor: pointer;
        }
        select:focus { border-color: var(--brand-gold); background: #fff; }

        /* --- 底部悬浮算分条 (核心功能) --- */
        .score-bar {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: 92%;
            max-width: 800px;
            background: var(--brand-navy);
            color: white;
            padding: 20px 30px;
            border-radius: 24px;
            display: flex;
            flex-direction: column;
            box-shadow: 0 15px 40px rgba(24, 43, 69, 0.4); /* 深色投影 */
            z-index: 1000;
            border: 2px solid rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
        }
        
        .score-header {
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255,255,255,0.15);
        }

        .score-label { font-size: 1.1rem; opacity: 0.9; font-weight: 500; }
        .total-score { font-size: 2.8rem; font-weight: 800; color: var(--brand-gold); line-height: 1; text-shadow: 0 2px 10px rgba(0,0,0,0.3); }
        
        /* 潜力分析钩子区域 */
        .score-hook-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 20px;
        }

        .hook-text {
            font-size: 0.9rem;
            margin: 0;
            flex: 1; 
            line-height: 1.5;
            color: #eee;
        }
        .hook-highlight { color: #4ade80; font-weight: bold; } /* 绿色高亮加分项 */

        .contact-btn {
            background: var(--brand-gold);
            color: var(--brand-navy);
            padding: 10px 20px;
            border-radius: 50px;
            font-weight: bold;
            text-decoration: none;
            font-size: 0.9rem;
            white-space: nowrap;
            transition: 0.2s;
        }
        .contact-btn:hover { background: #fff; transform: scale(1.05); }

        .hidden { display: none; }

        @media (max-width: 768px) {
            .form-grid { grid-template-columns: 1fr; }
            .full-width { grid-column: span 1; }
            .score-bar { padding: 15px 20px; bottom: 10px; width: 95%; }
            .score-header { margin-bottom: 10px; padding-bottom: 10px; }
            .total-score { font-size: 2.2rem; }
            .score-hook-container { flex-direction: column; text-align: left; align-items: flex-start; gap: 10px; }
            .contact-btn { width: 100%; text-align: center; }
        }
    </style>
</head>
<body>
    
    <div class="main-wrapper">
        <div class="container">
            <header>
                <a href="/" class="logo">KOTO <span style="color:var(--brand-gold)">IMMIGRATION</span></a>
                <a href="/" class="back-link">← 返回首页</a>
            </header>

            <h1>官方 CRS 移民算分器</h1>
            <p class="subtitle">基于 IRCC 官方最新算法 (2025版) • 实时精准评估</p>

            <form id="crsForm">
                
                <div class="section-card">
                    <h2>1. 婚姻状况 (Marital Status)</h2>
                    <div class="form-grid">
                        <div class="full-width">
                            <label>您的婚姻状况？</label>
                            <select id="maritalStatus" onchange="toggleSpouseSection(); runCalculations();">
                                <option value="single">单身 / 离异 / 丧偶</option>
                                <option value="married">已婚 / 同居伴侣</option>
                            </select>
                        </div>
                        <div class="full-width hidden" id="spouseComeDiv">
                            <label style="color:var(--brand-red);">您的配偶是加拿大公民或永久居民吗？</label>
                            <select id="spouseCanadian" onchange="toggleSpouseSection(); runCalculations();">
                                <option value="no">否 (配偶将随行移民)</option>
                                <option value="yes">是 (配偶已经是加拿大人)</option>
                            </select>
                            <p style="font-size:0.8rem; color:#888; margin-top:8px;">* 如果选择“是”，您将获得与单身人士相同的积分优势。</p>
                        </div>
                    </div>
                </div>

                <div class="section-card">
                    <h2>2. 核心背景 (Core Factors)</h2>
                    <div class="form-grid">
                        <div>
                            <label>年龄 (Age)</label>
                            <select id="age" onchange="runCalculations()">
                                <option value="17">17 岁及以下</option>
                                <option value="18">18 岁</option>
                                <option value="19">19 岁</option>
                                <option value="20">20-29 岁 (满分)</option> <option value="29" selected hidden>29</option> <option value="30">30 岁</option>
                                <option value="31">31 岁</option>
                                <option value="32">32 岁</option>
                                <option value="33">33 岁</option>
                                <option value="34">34 岁</option>
                                <option value="35">35 岁</option>
                                <option value="36">36 岁</option>
                                <option value="37">37 岁</option>
                                <option value="38">38 岁</option>
                                <option value="39">39 岁</option>
                                <option value="40">40 岁</option>
                                <option value="41">41 岁</option>
                                <option value="42">42 岁</option>
                                <option value="43">43 岁</option>
                                <option value="44">44 岁</option>
                                <option value="45">45 岁及以上</option>
                            </select>
                            </div>
                        <div>
                            <label>最高学历</label>
                            <select id="education" onchange="runCalculations()">
                                <option value="0">高中及以下</option>
                                <option value="30">高中毕业</option>
                                <option value="90">1年制大专/证书</option>
                                <option value="98">2年制大专/文凭</option>
                                <option value="120">本科 (3年以上) / 3年大专</option>
                                <option value="128">双学历 (其中一个为3年以上)</option>
                                <option value="135" selected>硕士学位 (Master's)</option>
                                <option value="150">博士学位 (PhD)</option>
                            </select>
                        </div>
                        <div class="full-width">
                            <label>加拿大本地工作经验 (年)</label>
                            <select id="cdnExp" onchange="runCalculations()">
                                <option value="0">无 / 不满1年</option>
                                <option value="40" selected>1 年</option>
                                <option value="53">2 年</option>
                                <option value="64">3 年</option>
                                <option value="72">4 年</option>
                                <option value="80">5 年及以上</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="section-card">
                    <h2>3. 语言能力 (Language)</h2>
                    
                    <h3>第一官方语言 (雅思 G类 / 思培)</h3>
                    <div class="form-grid">
                        <div>
                            <label>听力 (Listening)</label>
                            <select id="langListen" onchange="runCalculations()">
                                <option value="0">CLB 4 以下</option>
                                <option value="6">CLB 4-5</option>
                                <option value="9">CLB 6</option>
                                <option value="17">CLB 7 (雅思 6.0)</option>
                                <option value="23">CLB 8 (雅思 7.5)</option>
                                <option value="31" selected>CLB 9 (雅思 8.0)</option>
                                <option value="34">CLB 10 (雅思 8.5+)</option>
                            </select>
                        </div>
                        <div>
                            <label>口语 (Speaking)</label>
                            <select id="langSpeak" onchange="runCalculations()">
                                <option value="0">CLB 4 以下</option>
                                <option value="6">CLB 4-5</option>
                                <option value="9">CLB 6 (雅思 6.0)</option>
                                <option value="17">CLB 7 (雅思 6.0)</option>
                                <option value="23">CLB 8 (雅思 6.5)</option>
                                <option value="31" selected>CLB 9 (雅思 7.0)</option>
                                <option value="34">CLB 10 (雅思 7.5+)</option>
                            </select>
                        </div>
                        <div>
                            <label>阅读 (Reading)</label>
                            <select id="langRead" onchange="runCalculations()">
                                <option value="0">CLB 4 以下</option>
                                <option value="6">CLB 4-5</option>
                                <option value="9">CLB 6 (雅思 6.0)</option>
                                <option value="17">CLB 7 (雅思 6.0)</option>
                                <option value="23">CLB 8 (雅思 6.5)</option>
                                <option value="31" selected>CLB 9 (雅思 7.0)</option>
                                <option value="34">CLB 10 (雅思 8.0+)</option>
                            </select>
                        </div>
                        <div>
                            <label>写作 (Writing)</label>
                            <select id="langWrite" onchange="runCalculations()">
                                <option value="0">CLB 4 以下</option>
                                <option value="6">CLB 4-5</option>
                                <option value="9">CLB 6 (雅思 6.0)</option>
                                <option value="17">CLB 7 (雅思 6.0)</option>
                                <option value="23">CLB 8 (雅思 6.5)</option>
                                <option value="31" selected>CLB 9 (雅思 7.0)</option>
                                <option value="34">CLB 10 (雅思 7.5+)</option>
                            </select>
                        </div>
                    </div>

                    <h3>第二官方语言 (法语 TEF/TCF) - 选填</h3>
                    <div class="form-grid">
                        <div class="full-width">
                            <label>您的法语水平？</label>
                            <select id="lang2Select" onchange="updateFrench(); runCalculations();">
                                <option value="none">无法语成绩 / 低于 CLB 5</option>
                                <option value="clb5">基础 (CLB 5-6)</option>
                                <option value="clb7">中高级 (CLB 7+)</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="section-card hidden" id="spouseFactorsSection">
                    <h2>4. 配偶条件 (Spouse Factors)</h2>
                    <div class="form-grid">
                        <div>
                            <label>配偶学历</label>
                            <select id="spouseEdu" onchange="runCalculations()">
                                <option value="0">高中及以下</option>
                                <option value="6">1年制大专</option>
                                <option value="7">2年制大专</option>
                                <option value="8">3年以上学位</option>
                                <option value="9">双学历</option>
                                <option value="10">硕士或博士</option>
                            </select>
                        </div>
                        <div>
                            <label>配偶加拿大工作经验</label>
                            <select id="spouseCdnExp" onchange="runCalculations()">
                                <option value="0">无</option>
                                <option value="5">1 年</option>
                                <option value="7">2 年</option>
                                <option value="8">3 年</option>
                                <option value="9">4 年</option>
                                <option value="10">5 年及以上</option>
                            </select>
                        </div>
                        <div class="full-width">
                            <label>配偶语言水平 (雅思/思培)</label>
                            <select id="spouseLang" onchange="runCalculations()">
                                <option value="0">低 (CLB 4及以下)</option>
                                <option value="1">基础 (CLB 5/6)</option>
                                <option value="3">中等 (CLB 7/8)</option>
                                <option value="5">高 (CLB 9及以上)</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="section-card">
                    <h2>5. 额外加分项 (Additional Points)</h2>
                    <div class="form-grid">
                        <div class="full-width">
                            <label>海外(中国)工作经验</label>
                            <select id="foreignExp" onchange="runCalculations()">
                                <option value="0">无</option>
                                <option value="1">1 或 2 年</option>
                                <option value="3">3 年及以上</option>
                            </select>
                        </div>
                        <div>
                            <label>省提名 (PNP)</label>
                            <select id="pnp" onchange="runCalculations()">
                                <option value="0">无</option>
                                <option value="600">是 (+600分)</option>
                            </select>
                        </div>
                        <div>
                            <label>LMIA 雇主担保 (Job Offer)</label>
                            <select id="jobOffer" onchange="runCalculations()">
                                <option value="0">无</option>
                                <option value="50">普通职位 (+50)</option>
                                <option value="200">00类高管 (+200)</option>
                            </select>
                        </div>
                        <div>
                            <label>兄弟姐妹在加拿大 (公民/PR)</label>
                            <select id="sibling" onchange="runCalculations()">
                                <option value="0">无</option>
                                <option value="15">有 (+15)</option>
                            </select>
                        </div>
                        <div>
                            <label>加拿大本地学历</label>
                            <select id="cdnEdu" onchange="runCalculations()">
                                <option value="0">无</option>
                                <option value="15">1或2年文凭</option>
                                <option value="30" selected>3年以上学位/硕士/博士 (+30)</option>
                            </select>
                        </div>
                    </div>
                </div>

            </form>
        </div>
    </div>

    <div class="score-bar">
        <div class="score-header">
            <span class="score-label">您的 CRS 预估总分:</span>
            <span class="total-score" id="displayScore">0</span>
        </div>
        
        <div class="score-hook-container">
            <p class="hook-text" id="hookMessage">正在分析您的加分潜力...</p>
            <a href="/#contact" class="contact-btn">免费定制方案 →</a>
        </div>
    </div>

    <script>
        // --- 数据字典 (官方算法) ---
        // 20-29岁统一处理 (前端显示简化，逻辑保留)
        const agePointsSingle = {17:0, 18:99, 19:105, 20:110, 21:110, 22:110, 23:110, 24:110, 25:110, 26:110, 27:110, 28:110, 29:110, 30:105, 31:99, 32:94, 33:88, 34:83, 35:77, 36:72, 37:66, 38:61, 39:55, 40:50, 41:39, 42:28, 43:17, 44:6, 45:0};
        const agePointsMarried = {17:0, 18:90, 19:95, 20:100, 21:100, 22:100, 23:100, 24:100, 25:100, 26:100, 27:100, 28:100, 29:100, 30:95, 31:90, 32:85, 33:80, 34:75, 35:70, 36:65, 37:60, 38:55, 39:50, 40:45, 41:35, 42:25, 43:15, 44:5, 45:0};

        function getVal(id) { return parseInt(document.getElementById(id).value) || 0; }
        
        // 法语简化处理
        let lang2Vals = {s:0, l:0, r:0, w:0};
        function updateFrench() {
            const level = document.getElementById('lang2Select').value;
            if(level === 'clb7') lang2Vals = {s:6, l:6, r:6, w:6}; // CLB 7+
            else if(level === 'clb5') lang2Vals = {s:1, l:1, r:1, w:1}; // CLB 5
            else lang2Vals = {s:0, l:0, r:0, w:0};
        }

        function toggleSpouseSection() {
            const status = document.getElementById('maritalStatus').value;
            const spouseDiv = document.getElementById('spouseComeDiv');
            const factorsDiv = document.getElementById('spouseFactorsSection');
            
            if(status === 'married') {
                spouseDiv.classList.remove('hidden');
                const isCdn = document.getElementById('spouseCanadian').value === 'yes';
                // 如果配偶是加拿大人，不需要填配偶条件（因为按单身算）
                if(!isCdn) factorsDiv.classList.remove('hidden');
                else factorsDiv.classList.add('hidden');
            } else {
                spouseDiv.classList.add('hidden');
                factorsDiv.classList.add('hidden');
            }
        }

        // --- 核心算法引擎 ---
        function calculateCRSFromData(data) {
            let score = 0;
            // 判定是否按“已婚标准”算分 (已婚 且 配偶不随行/非公民)
            let isMarriedCalc = (data.maritalStatus === 'married' && data.spouseCanadian === 'no');

            // 1. 核心人力资本 (Human Capital)
            // A. 年龄
            // 处理20-29岁的简化逻辑
            let age = data.age;
            if(age >= 20 && age <= 29) age = 29; 
            score += isMarriedCalc ? (agePointsMarried[age] || 0) : (agePointsSingle[age] || 0);

            // B. 学历
            let eduScore = data.education;
            if(isMarriedCalc) {
                // 已婚表折算
                if(data.education == 150) eduScore = 140; 
                else if(data.education == 135) eduScore = 126; 
                else if(data.education == 128) eduScore = 119; 
                else if(data.education == 120) eduScore = 112; 
                else if(data.education == 98) eduScore = 91; 
                else if(data.education == 90) eduScore = 84; 
                else if(data.education == 30) eduScore = 28; 
            }
            score += eduScore;

            // C. 语言
            let langTotal = 0;
            if(isMarriedCalc) {
                let adjust = (val) => {
                    if(val==34) return 32; if(val==31) return 29; 
                    if(val==23) return 22; if(val==17) return 16; 
                    if(val==9) return 6; return 0;
                };
                langTotal = adjust(data.langSpeak) + adjust(data.langListen) + adjust(data.langRead) + adjust(data.langWrite);
            } else {
                langTotal = data.langSpeak + data.langListen + data.langRead + data.langWrite;
            }
            score += langTotal;
            
            // 法语加分
            score += (data.lang2.s + data.lang2.l + data.lang2.r + data.lang2.w);

            // D. 加拿大工作
            let cdnScore = data.cdnExp;
            if(isMarriedCalc) {
                if(data.cdnExp == 80) cdnScore = 70;
                else if(data.cdnExp == 72) cdnScore = 63;
                else if(data.cdnExp == 64) cdnScore = 56;
                else if(data.cdnExp == 53) cdnScore = 46;
                else if(data.cdnExp == 40) cdnScore = 35;
            }
            score += cdnScore;

            // 配偶加分 (仅适用于 isMarriedCalc)
            if(isMarriedCalc) {
                score += data.spouseEdu;
                score += data.spouseCdnExp;
                score += (data.spouseLang * 5); // 配偶语言满分20 (5*4)
            }

            // 2. 交叉项 (Transferability) - 上限100分
            let clb7Count = 0; let clb9Count = 0; 
            [data.langSpeak, data.langListen, data.langRead, data.langWrite].forEach(val => {
                if(val >= 31) clb9Count++; // CLB 9
                if(val >= 17) clb7Count++; // CLB 7
            });

            // 学历交叉项
            let transferEdu = 0;
            let eduHigh = (data.education >= 128); // 双学历及以上
            let eduPostSec = (data.education >= 90); // 1年大专以上

            // 学历 + 语言
            if(eduHigh && clb9Count == 4) transferEdu += 50;
            else if(eduHigh && clb7Count == 4) transferEdu += 25;
            else if(eduPostSec && clb9Count == 4) transferEdu += 25;
            else if(eduPostSec && clb7Count == 4) transferEdu += 13;

            // 学历 + 加拿大工作
            let cdn1yr = (data.cdnExp >= 40); 
            let cdn2yr = (data.cdnExp >= 53); 

            if(eduHigh && cdn2yr) transferEdu += 50;
            else if(eduHigh && cdn1yr) transferEdu += 25;
            else if(eduPostSec && cdn2yr) transferEdu += 25;
            else if(eduPostSec && cdn1yr) transferEdu += 13;
            if(transferEdu > 50) transferEdu = 50; // 学历类交叉项上限50

            // 海外工作交叉项
            let transferForeign = 0;
            let for3yr = (data.foreignExp >= 3);
            let for1yr = (data.foreignExp >= 1);

            // 海外工作 + 语言
            if(for3yr && clb9Count == 4) transferForeign += 50;
            else if(for3yr && clb7Count == 4) transferForeign += 25;
            else if(for1yr && clb9Count == 4) transferForeign += 25;
            else if(for1yr && clb7Count == 4) transferForeign += 13;

            // 海外工作 + 加拿大工作
            if(for3yr && cdn2yr) transferForeign += 50;
            else if(for3yr && cdn1yr) transferForeign += 25;
            else if(for1yr && cdn2yr) transferForeign += 25;
            else if(for1yr && cdn1yr) transferForeign += 13;
            if(transferForeign > 50) transferForeign = 50;
            
            let totalTransfer = transferEdu + transferForeign;
            if(totalTransfer > 100) totalTransfer = 100;
            score += totalTransfer;

            // 3. 额外加分项 (Additional) - 上限600
            let addScore = 0;
            addScore += data.pnp;
            addScore += data.jobOffer;
            addScore += data.sibling;
            addScore += data.cdnEdu;

            // 法语强力加分 (CLB 7+ in all 4 skills)
            let french7Count = 0;
            [data.lang2.s, data.lang2.l, data.lang2.r, data.lang2.w].forEach(val => { if(val >= 3) french7Count++; }); // 3对应CLB7
            if(french7Count === 4) {
                let engScore = data.langSpeak + data.langListen + data.langRead + data.langWrite;
                if(engScore >= 24) addScore += 50; // 法语+英语
                else addScore += 25; // 仅法语
            }

            if(addScore > 600) addScore = 600;
            score += addScore;

            return score;
        }

        // --- 核心驱动函数 ---
        function runCalculations() {
            // 收集当前数据
            let currentData = {
                maritalStatus: document.getElementById('maritalStatus').value,
                spouseCanadian: document.getElementById('spouseCanadian').value,
                age: getVal('age'),
                education: getVal('education'),
                cdnExp: getVal('cdnExp'),
                langSpeak: getVal('langSpeak'),
                langListen: getVal('langListen'),
                langRead: getVal('langRead'),
                langWrite: getVal('langWrite'),
                lang2: lang2Vals,
                spouseEdu: getVal('spouseEdu'),
                spouseCdnExp: getVal('spouseCdnExp'),
                spouseLang: getVal('spouseLang'),
                foreignExp: getVal('foreignExp'),
                pnp: getVal('pnp'),
                jobOffer: getVal('jobOffer'),
                sibling: getVal('sibling'),
                cdnEdu: getVal('cdnEdu')
            };

            let currentScore = calculateCRSFromData(currentData);
            
            // 动画跳动效果
            let displayElem = document.getElementById('displayScore');
            animateValue(displayElem, parseInt(displayElem.innerText), currentScore, 500);

            // --- 潜能分析逻辑 (The Hook) ---
            // 这是一个销售转化的关键：告诉客户“你可以更高”
            
            let potentialData = JSON.parse(JSON.stringify(currentData)); // 深拷贝
            
            // 假设：通过我们辅导，客户可以达到硕士学历、雅思8777 (CLB 9)、有一点法语基础
            if(potentialData.education < 135) potentialData.education = 135; // 规划读硕
            if(potentialData.langSpeak < 31) potentialData.langSpeak = 31; // 雅思刷到 8777
            if(potentialData.langListen < 31) potentialData.langListen = 31;
            if(potentialData.langRead < 31) potentialData.langRead = 31;
            if(potentialData.langWrite < 31) potentialData.langWrite = 31;
            if(potentialData.foreignExp < 1) potentialData.foreignExp = 1; // 凑一年海外经验

            let potentialScore = calculateCRSFromData(potentialData);
            let boost = potentialScore - currentScore;

            let msg = "";
            if(boost > 0) {
                msg = `如果雅思刷到 8777 或提升学历，<br>您的分数可涨至 <span class="hook-highlight">${potentialScore} 分</span> (+${boost})`;
            } else if(currentScore > 480) {
                msg = `您的分数 <span class="hook-highlight">非常有竞争力</span>！<br>建议立即联系我们入池。`;
            } else {
                msg = "核心分数已近上限，建议考虑 <span class="hook-highlight">LMIA 或 PNP</span> 弯道超车。";
            }
            document.getElementById('hookMessage').innerHTML = msg;
        }

        // 数字滚动动画
        function animateValue(obj, start, end, duration) {
            let startTimestamp = null;
            const step = (timestamp) => {
                if (!startTimestamp) startTimestamp = timestamp;
                const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                obj.innerHTML = Math.floor(progress * (end - start) + start);
                if (progress < 1) {
                    window.requestAnimationFrame(step);
                }
            };
            window.requestAnimationFrame(step);
        }

        // 初始化
        toggleSpouseSection();
        updateFrench();
        runCalculations();
    </script>
</body>
</html>
